var passport=require("passport"),LocalStrategy=require("passport-local").Strategy,User=require("./models/user");module.exports=function(){passport.serializeUser((function(e,s){s(null,e._id)})),passport.deserializeUser((function(e,s){User.findById(e,(function(e,r){s(e,r)}))})),passport.use("login",new LocalStrategy({usernameField:"email",passwordField:"password"},(function(e,s,r){User.findOne({email:e},(function(e,i){return e?r(e):i?void i.checkPassword(s,(function(e,s){return e?r(e):s?r(null,i):r(null,!1,{message:"falsches Passwort"})})):r(null,!1,{message:"Dieser Nutzer existiert nicht"})}))})))};