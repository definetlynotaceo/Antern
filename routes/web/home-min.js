var express=require("express"),passport=require("passport"),User=require("../../models/user"),router=express.Router();router.get("/",(function(e,r){r.render("home/")})),router.get("/home",(function(e,r){r.render("home/home")})),router.get("/about",(function(e,r){r.render("home/about")})),router.get("/login",(function(e,r){r.render("home/login")})),router.get("/logout",(function(e,r){e.logout(),r.redirect("/home")})),router.post("/login",passport.authenticate("login",{successRedirect:"/home",failureRedirect:"/",failureFlash:!0})),router.get("/signup",(function(e,r){r.render("home/signup")})),router.post("/signup",(function(e,r,o){var t=e.body.username,s=e.body.email,u=e.body.password;User.findOne({email:s},(function(i,n){return i?o(i):n?(e.flash("error","There's already an account with this email"),r.redirect("/signup")):void new User({username:t,password:u,email:s}).save(o)}))}),passport.authenticate("login",{successRedirect:"/login",failureRedirect:"/signup",failureFlash:!0})),module.exports=router;